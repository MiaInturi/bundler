asyncapi: 3.0.0
info:
  title: Schema context refs fixture
  version: 1.0.0
channels:
  schemaChecks:
    address: schema/checks
    messages:
      checked:
        headers:
          type: object
          properties:
            owner:
              $ref: ./schemas/Owner.yaml
        payload:
          type: object
          properties:
            pet:
              $ref: ./schemas/Pet.yaml
          allOf:
            - $ref: ./schemas/Pet.yaml
            - type: object
              properties:
                owner:
                  $ref: ./schemas/Owner.yaml
          anyOf:
            - $ref: ./schemas/Pet.yaml
            - type: object
              properties:
                owners:
                  type: array
                  items:
                    $ref: ./schemas/Owner.yaml
components:
  schemas:
    Bag:
      type: object
      additionalProperties:
        $ref: ./schemas/Pet.yaml
operations:
  receiveChecked:
    action: receive
    channel:
      $ref: '#/channels/schemaChecks'
    messages:
      - $ref: '#/channels/schemaChecks/messages/checked'
